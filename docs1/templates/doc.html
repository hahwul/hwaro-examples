{% include "header.html" %}
  <main class="max-w-7xl mx-auto px-6 min-h-[calc(100vh-200px)] pt-10 grid grid-cols-1 md:grid-cols-[260px_1fr] gap-10">
    <aside class="md:border-r md:border-border md:pr-6 border-b md:border-b-0 border-border pb-6 md:pb-0 h-fit sticky top-24 self-start overflow-y-auto max-h-[calc(100vh-8rem)]">
      {% if section.pages %}
      <nav>
        <h3 class="text-xs uppercase tracking-wider text-muted mb-4 font-semibold">{{ section.title }}</h3>
        <ul class="list-none p-0 m-0 space-y-1">
          {% for doc in section.pages %}
          <li>
            <a href="{{ doc.url }}" class="sidebar-link {% if doc.url == page.url %}active{% endif %}">
              {{ doc.title }}
            </a>
          </li>
          {% endfor %}
        </ul>
      </nav>
      {% endif %}
    </aside>
    <article class="min-w-0 pb-20">
      <div class="text-sm text-muted mb-4 flex items-center gap-2">
        <a href="{{ base_url }}/" class="text-muted no-underline hover:text-primary-light transition-colors">Home</a>
        {%- for ancestor in page.ancestors -%}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-zinc-600">
          <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
        </svg>
        <a href="{{ ancestor.url }}" class="text-muted no-underline hover:text-primary-light transition-colors">{{ ancestor.title }}</a>
        {%- endfor -%}
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-zinc-600">
          <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
        </svg>
        <span class="text-zinc-200">{{ page.title }}</span>
      </div>

      <div class="flex flex-col gap-4 mb-8">
        <div class="flex items-center gap-3">
          {% if page.extra.method %}<span class="method-badge method-{{ page.extra.method | lower }} text-xs px-2.5 py-1">{{ page.extra.method }}</span>{% endif %}
          <h1 class="text-3xl font-bold m-0 text-text-head tracking-tight">{{ page.title }}</h1>
        </div>
        {% if page.description %}<p class="text-zinc-400 text-lg leading-relaxed m-0">{{ page.description }}</p>{% endif %}
      </div>

      {% if page.extra.api_path %}
      <div class="font-mono text-sm bg-surface-alt border border-border text-primary-light px-4 py-3 rounded-xl mb-8 flex items-center gap-3 shadow-sm">
        <span class="text-zinc-500 uppercase text-[10px] font-bold tracking-widest select-none">Endpoint</span>
        <span>{{ page.extra.api_path }}</span>
      </div>
      {% endif %}

      {% if toc %}
      <nav class="toc-container xl:hidden border border-border p-4 mb-8 bg-surface-alt/50 rounded-xl">
        <h4 class="m-0 mb-3 text-xs uppercase tracking-wider text-zinc-500 font-bold">On this page</h4>
        {{ toc }}
      </nav>
      {% endif %}

      <div class="prose max-w-none">
        {{ content }}
      </div>

      <nav class="flex justify-between mt-16 pt-8 border-t border-border">
        {% if page.lower %}
        <a href="{{ page.lower.url }}" class="group flex flex-col gap-1 no-underline max-w-[45%] text-left">
          <span class="text-xs text-muted uppercase tracking-wider font-medium">Previous</span>
          <span class="text-primary-light font-medium group-hover:text-primary transition-colors flex items-center gap-2">
            &larr; {{ page.lower.title }}
          </span>
        </a>
        {% else %}
        <div></div>
        {% endif %}

        {% if page.higher %}
        <a href="{{ page.higher.url }}" class="group flex flex-col gap-1 no-underline max-w-[45%] text-right items-end">
          <span class="text-xs text-muted uppercase tracking-wider font-medium">Next</span>
          <span class="text-primary-light font-medium group-hover:text-primary transition-colors flex items-center gap-2">
             {{ page.higher.title }} &rarr;
          </span>
        </a>
        {% endif %}
      </nav>
    </article>
    <!-- Right Sidebar for TOC (XL screens only) -->
    {% if toc %}
    <aside class="hidden xl:block w-64 sticky top-24 self-start max-h-[calc(100vh-8rem)] overflow-y-auto pl-6 border-l border-border/50">
      <h4 class="m-0 mb-4 text-xs uppercase tracking-wider text-muted font-semibold">On this page</h4>
      <nav class="toc-container">
        {{ toc }}
      </nav>
    </aside>
    {% endif %}
  </main>
{% include "footer.html" %}
